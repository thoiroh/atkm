<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Guide d'installation - Atomeek DataMatrix</title>
  <link rel="stylesheet" href="atk.docs.global.styles.css">
  <style>
    /* Styles pour les boutons de copie */
    .code-container {
      position: relative;
    }

    .copy-button {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #e74c3c;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.8em;
      font-weight: bold;
      transition: all 0.3s ease;
      z-index: 10;
    }

    .copy-button:hover {
      background: #c0392b;
      transform: scale(1.05);
    }

    .copy-button.copied {
      background: #27ae60;
      transform: scale(1.1);
    }
  </style>
</head>

<body>
  <div class="document-container">
    <div class="document-wrapper">
      <div class="document-header">
        <h1 class="document-title">üìÅ guide d'installation - atomeek datamatrix</h1>
        <div class="document-subtitle">Configuration compl√®te Angular 20 + PHP 8.3 + Docker sur Windows 11</div>
      </div>

      <div class="metadata-section">
        <div class="metadata-box">
          <div class="metadata-item">
            <span class="metadata-label">üìÖ Date :</span> 7 ao√ªt 2025
          </div>
          <div class="metadata-item">
            <span class="metadata-label">üë§ Projet :</span> atomeek-datamatrix
          </div>
          <div class="metadata-item">
            <span class="metadata-label">üèóÔ∏è Stack :</span> Angular 20 + PHP 8.3 + Docker
          </div>
          <div class="metadata-item">
            <span class="metadata-label">üìä Status :</span> <span class="status-success">‚úÖ Pr√™t pour installation</span>
          </div>
        </div>
      </div>

      <div class="main-content">
        <div class="content-section">
          <h2 class="section-title"><span class="emoji-icon">1Ô∏è‚É£</span>pr√©requis syst√®me</h2>

          <div class="cards-grid">
            <div class="info-card">
              <h4 class="card-title">üñ•Ô∏è syst√®me windows 11</h4>
              <div class="card-content">
                <ul class="content-list">
                  <li class="list-item">Windows 11 Pro/Home (build 22000+)</li>
                  <li class="list-item">RAM : Minimum 8GB (16GB recommand√©)</li>
                  <li class="list-item">Stockage : 20GB libres minimum</li>
                  <li class="list-item">Virtualisation : Hyper-V activ√©</li>
                </ul>
              </div>
            </div>

            <div class="info-card">
              <h4 class="card-title">üõ†Ô∏è outils de d√©veloppement</h4>
              <div class="card-content">
                <ul class="content-list">
                  <li class="list-item">Node.js : Version 20.x LTS</li>
                  <li class="list-item">Git : Version r√©cente</li>
                  <li class="list-item">VS Code : Avec extensions Docker</li>
                  <li class="list-item">Docker Desktop : Version r√©cente</li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div class="content-section">
          <h2 class="section-title"><span class="emoji-icon">2Ô∏è‚É£</span>installation docker windows 11</h2>

          <div class="alert-box alert-warning">
            <strong>‚ö†Ô∏è Attention :</strong> Installation Docker sur Windows 11 n√©cessite une configuration syst√®me
            pr√©cise. Suivre chaque √©tape scrupuleusement.
          </div>

          <h3 class="section-subtitle">üîß √©tape 1 : activation de la virtualisation</h3>
          <div class="steps-container">
            <div class="steps-title">V√©rification BIOS/UEFI :</div>
            <ol class="steps-list">
              <li class="step-item">Red√©marrer le PC et acc√©der au BIOS/UEFI (F2, F12, DEL selon constructeur)</li>
              <li class="step-item">Chercher "Virtualization Technology" ou "Intel VT-x/AMD-V"</li>
              <li class="step-item">Activer la virtualisation</li>
              <li class="step-item">Sauvegarder et red√©marrer</li>
            </ol>
          </div>

          <h3 class="section-subtitle">üîß √©tape 2 : activation wsl2 et hyper-v</h3>
          <div class="steps-title">PowerShell en tant qu'administrateur :</div>
          <div class="code-container">
            <div class="code-block">
              <pre># Enable WSL2
dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart

# Enable Virtual Machine Platform
dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart

# Enable Hyper-V
dism.exe /online /enable-feature /featurename:Microsoft-Hyper-V-All /all /norestart

# Restart required
Restart-Computer</pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>

          <h3 class="section-subtitle">üîß √©tape 3 : installation wsl2 kernel</h3>
          <div class="steps-container">
            <div class="steps-title">Apr√®s red√©marrage :</div>
            <ol class="steps-list">
              <li class="step-item">T√©l√©charger le kernel WSL2 : <code>https://aka.ms/wsl2kernel</code></li>
              <li class="step-item">Installer le fichier MSI t√©l√©charg√©</li>
              <li class="step-item">D√©finir WSL2 par d√©faut :</li>
            </ol>
          </div>
          <div class="code-container">
            <div class="code-block">
              <pre>wsl --set-default-version 2</pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>

          <h3 class="section-subtitle">üîß √©tape 4 : installation docker desktop</h3>
          <div class="steps-container">
            <ol class="steps-list">
              <li class="step-item">T√©l√©charger Docker Desktop :
                <code>https://www.docker.com/products/docker-desktop</code>
              </li>
              <li class="step-item">Lancer l'installateur en tant qu'administrateur</li>
              <li class="step-item">Cocher "Use WSL 2 instead of Hyper-V"</li>
              <li class="step-item">Cocher "Add shortcut to desktop"</li>
              <li class="step-item">Installer et red√©marrer</li>
            </ol>
          </div>

          <h3 class="section-subtitle">üîß √©tape 5 : configuration docker desktop</h3>
          <div class="steps-container">
            <ol class="steps-list">
              <li class="step-item">Lancer Docker Desktop</li>
              <li class="step-item">Aller dans Settings ‚Üí General</li>
              <li class="step-item">V√©rifier "Use WSL 2 based engine"</li>
              <li class="step-item">Aller dans Resources ‚Üí WSL Integration</li>
              <li class="step-item">Activer l'int√©gration avec les distributions WSL</li>
              <li class="step-item">Apply & Restart</li>
            </ol>
          </div>

          <h3 class="section-subtitle">‚úÖ v√©rification installation</h3>
          <div class="code-container">
            <div class="code-block">
              <pre># Test Docker
docker --version
docker run hello-world

# Test Docker Compose
docker-compose --version</pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>
        </div>

        <div class="content-section">
          <h2 class="section-title"><span class="emoji-icon">3Ô∏è‚É£</span>structure du projet</h2>

          <h3 class="section-subtitle">üìÅ structure des dossiers</h3>
          <div class="code-container">
            <div class="code-block">
              <pre>atomeek-datamatrix/
‚îú‚îÄ‚îÄ .git/
‚îú‚îÄ‚îÄ assets/                   # Assets partag√©s
‚îú‚îÄ‚îÄ atkm/                    # Frontend Angular 20
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ environments/
‚îÇ   ‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îú‚îÄ‚îÄ angular.json
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îú‚îÄ‚îÄ proxy.conf.json
‚îÇ   ‚îî‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ atkm_back/               # Backend PHP 8.3
‚îÇ   ‚îú‚îÄ‚îÄ public/               # Point d'entr√©e web
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .htaccess        # Configuration Apache
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ uploads/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app/             # Classes PHP (namespace App\)
‚îÇ   ‚îú‚îÄ‚îÄ vendor/
‚îÇ   ‚îú‚îÄ‚îÄ composer.json
‚îÇ   ‚îî‚îÄ‚îÄ .env
‚îú‚îÄ‚îÄ database/                 # Schemas et migrations
‚îÇ   ‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îú‚îÄ‚îÄ seeds/
‚îÇ   ‚îî‚îÄ‚îÄ schema.sql
‚îú‚îÄ‚îÄ docker/                   # Configuration Docker
‚îÇ   ‚îú‚îÄ‚îÄ nginx/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ nginx.conf
‚îÇ   ‚îú‚îÄ‚îÄ php/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ php.ini
‚îÇ   ‚îî‚îÄ‚îÄ mysql/
‚îú‚îÄ‚îÄ docs/                     # Documentation
‚îú‚îÄ‚îÄ scripts/                  # Scripts utilitaires
‚îú‚îÄ‚îÄ shared/                   # Code partag√©
‚îú‚îÄ‚îÄ docker-compose.yml        # Configuration containers
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ atk.ai.code-workspace    # Workspace VS Code
‚îú‚îÄ‚îÄ LICENSE
‚îî‚îÄ‚îÄ README.md</pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>
        </div>

        <div class="content-section">
          <h2 class="section-title"><span class="emoji-icon">4Ô∏è‚É£</span>configuration docker</h2>

          <h3 class="section-subtitle">üê≥ docker-compose.yml</h3>
          <div class="file-path">Chemin : /docker-compose.yml</div>
          <div class="code-container">
            <div class="code-block">
              <pre>version: '3.8'

services:
  # MySQL Database
  mysql:
    image: mysql:8.0
    container_name: atomeek_mysql
    restart: unless-stopped
    environment:
      MYSQL_ROOT_PASSWORD: root_password
      MYSQL_DATABASE: atomeek_datamatrix
      MYSQL_USER: atomeek_user
      MYSQL_PASSWORD: atomeek_pass
    ports:
      - "3306:3306"
    volumes:
      - mysql_data:/var/lib/mysql
      - ./database/schema.sql:/docker-entrypoint-initdb.d/01-schema.sql
    networks:
      - atomeek_network

  # PHP-FPM 8.3
  php:
    build:
      context: ./docker/php
      dockerfile: Dockerfile
    container_name: atomeek_php
    restart: unless-stopped
    volumes:
      - ./atkm_back:/var/www/html
    environment:
      - DB_HOST=mysql
      - DB_NAME=atomeek_datamatrix
      - DB_USER=atomeek_user
      - DB_PASS=atomeek_pass
      - PHP_ENV=development
    depends_on:
      - mysql
    networks:
      - atomeek_network

  # Nginx
  nginx:
    image: nginx:1.25
    container_name: atomeek_nginx
    restart: unless-stopped
    ports:
      - "8000:80"
    volumes:
      - ./atkm_back/public:/var/www/html/public
      - ./docker/nginx/nginx.conf:/etc/nginx/conf.d/default.conf
    depends_on:
      - php
    networks:
      - atomeek_network

  # Angular Development Server
  angular:
    build:
      context: ./atkm
      dockerfile: Dockerfile
    container_name: atomeek_angular
    restart: unless-stopped
    ports:
      - "4200:4200"
    volumes:
      - ./atkm:/app
      - /app/node_modules
    environment:
      - NODE_ENV=development
    networks:
      - atomeek_network

  # PhpMyAdmin (optional)
  phpmyadmin:
    image: phpmyadmin:5.2
    container_name: atomeek_phpmyadmin
    restart: unless-stopped
    environment:
      PMA_HOST: mysql
      PMA_USER: atomeek_user
      PMA_PASSWORD: atomeek_pass
    ports:
      - "8080:80"
    depends_on:
      - mysql
    networks:
      - atomeek_network

  # Redis for caching (optional)
  redis:
    image: redis:7.2-alpine
    container_name: atomeek_redis
    restart: unless-stopped
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    networks:
      - atomeek_network

volumes:
  mysql_data:
  redis_data:

networks:
  atomeek_network:
    driver: bridge</pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>

          <h3 class="section-subtitle">üêò dockerfile php</h3>
          <div class="file-path">Chemin : /docker/php/Dockerfile</div>
          <div class="code-container">
            <div class="code-block">
              <pre>FROM php:8.3-fpm

# Install system dependencies
RUN apt-get update && apt-get install -y \
    git \
    curl \
    libpng-dev \
    libonig-dev \
    libxml2-dev \
    libzip-dev \
    zip \
    unzip \
    libfreetype6-dev \
    libjpeg62-turbo-dev \
    libgd-dev \
    nano \
    vim \
    && rm -rf /var/lib/apt/lists/*

# Install PHP extensions
RUN docker-php-ext-configure gd --with-freetype --with-jpeg \
    && docker-php-ext-install -j$(nproc) \
    pdo_mysql \
    mbstring \
    exif \
    pcntl \
    bcmath \
    gd \
    zip \
    intl \
    opcache \
    sockets

# Install Composer
COPY --from=composer:latest /usr/bin/composer /usr/bin/composer

# PHP Configuration
COPY php.ini /usr/local/etc/php/conf.d/custom.ini

# Set working directory
WORKDIR /var/www/html

# Set permissions
RUN chown -R www-data:www-data /var/www/html \
    && chmod -R 755 /var/www/html

# Expose port
EXPOSE 9000

# Start PHP-FPM
CMD ["php-fpm"]</pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>

          <h3 class="section-subtitle">‚öôÔ∏è configuration php</h3>
          <div class="file-path">Chemin : /docker/php/php.ini</div>
          <div class="code-container">
            <div class="code-block">
              <pre>; PHP Configuration for Atomeek DataMatrix

; Memory and execution limits
memory_limit = 512M
max_execution_time = 300
max_input_time = 300

; File uploads
file_uploads = On
upload_max_filesize = 50M
max_file_uploads = 20
post_max_size = 100M

; Sessions
session.save_handler = files
session.save_path = "/tmp"
session.use_cookies = 1
session.cookie_httponly = 1
session.cookie_secure = 0
session.cookie_samesite = "Lax"
session.gc_maxlifetime = 86400

; Error handling and logging
display_errors = Off
display_startup_errors = Off
log_errors = On
error_reporting = E_ALL & ~E_DEPRECATED & ~E_STRICT
error_log = /var/log/php_errors.log

; Date and timezone
date.timezone = "Europe/Paris"

; OPcache for performance
opcache.enable = 1
opcache.enable_cli = 1
opcache.memory_consumption = 256
opcache.interned_strings_buffer = 16
opcache.max_accelerated_files = 10000
opcache.revalidate_freq = 2
opcache.save_comments = 1

; Security
expose_php = Off
allow_url_fopen = Off
allow_url_include = Off

; Performance
realpath_cache_size = 4096K
realpath_cache_ttl = 600

; Variables
max_input_vars = 3000
max_input_nesting_level = 64</pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>

          <h3 class="section-subtitle">üåê configuration nginx</h3>
          <div class="file-path">Chemin : /docker/nginx/nginx.conf</div>
          <div class="code-container">
            <div class="code-block">
              <pre>server {
    listen 80;
    server_name localhost;

    root /var/www/html/public;
    index index.php index.html;

    # Logs
    access_log /var/log/nginx/access.log;
    error_log /var/log/nginx/error.log;

    # Security
    server_tokens off;

    # Static files
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
        add_header Access-Control-Allow-Origin "*";
        access_log off;
    }

    # Main routes and API
    location / {
        try_files $uri $uri/ /index.php?$query_string;

        # CORS headers
        add_header Access-Control-Allow-Origin "*" always;
        add_header Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS, PATCH" always;
        add_header Access-Control-Allow-Headers "Origin, X-Requested-With, Content-Type, Accept, Authorization, Cache-Control" always;
        add_header Access-Control-Max-Age "3600" always;

        # Handle OPTIONS requests
        if ($request_method = OPTIONS) {
            add_header Access-Control-Allow-Origin "*";
            add_header Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS, PATCH";
            add_header Access-Control-Allow-Headers "Origin, X-Requested-With, Content-Type, Accept, Authorization, Cache-Control";
            add_header Access-Control-Max-Age "3600";
            return 200;
        }
    }

    # Uploads handling
    location /uploads/ {
        alias /var/www/html/public/uploads/;
        add_header Access-Control-Allow-Origin "*";
        expires 30d;
    }

    # PHP processing
    location ~ \.php$ {
        include fastcgi_params;
        fastcgi_pass php:9000;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;

        # Timeouts for large operations
        fastcgi_read_timeout 300;
        fastcgi_send_timeout 300;
        fastcgi_connect_timeout 300;

        # Buffers
        fastcgi_buffer_size 128k;
        fastcgi_buffers 4 256k;
        fastcgi_busy_buffers_size 256k;
    }

    # Security - block sensitive files
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }

    location ~ \.(env|ini|log|sh|sql)$ {
        deny all;
        access_log off;
        log_not_found off;
    }

    # Size limits
    client_max_body_size 100M;
    client_body_timeout 120s;
    client_header_timeout 120s;
}</pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>
        </div>

        <div class="content-section">
          <h2 class="section-title"><span class="emoji-icon">5Ô∏è‚É£</span>backend php</h2>

          <h3 class="section-subtitle">üì¶ composer.json</h3>
          <div class="file-path">Chemin : /atkm_back/composer.json</div>
          <div class="code-container">
            <div class="code-block">
              <pre>{
    "name": "atomeek/datamatrix-backend",
    "description": "Backend API pour Atomeek DataMatrix",
    "type": "project",
    "license": "proprietary",
    "require": {
        "php": "^8.3",
        "ext-pdo": "*",
        "ext-json": "*",
        "ext-mbstring": "*",
        "ext-openssl": "*",
        "binance/binance-connector-php": "^1.6",
        "cboden/ratchet": "^0.4.4",
        "vlucas/phpdotenv": "^5.6",
        "firebase/php-jwt": "^6.10",
        "ramsey/uuid": "^4.7",
        "monolog/monolog": "^3.5",
        "respect/validation": "^2.3",
        "league/flysystem": "^3.28",
        "intervention/image": "^3.7",
        "predis/predis": "^2.2",
        "symfony/http-foundation": "^7.1",
        "guzzlehttp/guzzle": "^7.8"
    },
    "require-dev": {
        "phpunit/phpunit": "^11.0",
        "squizlabs/php_codesniffer": "^3.10",
        "phpstan/phpstan": "^1.10",
        "mockery/mockery": "^1.6"
    },
    "autoload": {
        "psr-4": {
            "App\\": "src/app/"
        }
    },
    "autoload-dev": {
        "psr-4": {
            "App\\Tests\\": "tests/"
        }
    },
    "config": {
        "optimize-autoloader": true,
        "sort-packages": true,
        "allow-plugins": {
            "composer/package-versions-deprecated": true
        }
    },
    "scripts": {
        "test": "phpunit",
        "test-coverage": "phpunit --coverage-html coverage",
        "cs-fix": "phpcbf",
        "cs-check": "phpcs",
        "analyse": "phpstan analyse src tests --level=7",
        "post-install-cmd": [
            "@php -r \"file_exists('.env') || copy('.env.example', '.env');\""
        ]
    },
    "minimum-stability": "stable",
    "prefer-stable": true
}</pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>

          <h3 class="section-subtitle">üîß configuration apache (.htaccess)</h3>
          <div class="file-path">Chemin : /atkm_back/public/.htaccess</div>
          <div class="code-container">
            <div class="code-block">
              <pre># Enable URL rewriting
RewriteEngine On

# Remove PHP extension from URLs (clean URLs)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^\.]+)$ $1.php [NC,L]

# Handle OPTIONS requests for CORS
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

# CORS headers for API
Header always set Access-Control-Allow-Origin "*"
Header always set Access-Control-Max-Age "1000"
Header always set Access-Control-Allow-Headers "X-Requested-With, Content-Type, Origin, Authorization, Accept, SecurityToken, Accept-Encoding"
Header always set Access-Control-Allow-Methods "POST, GET, OPTIONS, DELETE, PUT"

# Security headers
Header always set X-Content-Type-Options nosniff
Header always set X-Frame-Options DENY
Header always set X-XSS-Protection "1; mode=block"
Header always set Referrer-Policy "strict-origin-when-cross-origin"

# Cache for static assets
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType text/css "access plus 1 year"
    ExpiresByType application/javascript "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
</IfModule>

# Gzip compression
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
    AddOutputFilterByType DEFLATE application/json
</IfModule>

# Block sensitive files
<FilesMatch "\.(env|ini|log|sh|sql)$">
    Order allow,deny
    Deny from all
</FilesMatch></pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>

          <h3 class="section-subtitle">üåê point d'entr√©e api</h3>
          <div class="file-path">Chemin : /atkm_back/public/index.php</div>
          <div class="code-container">
            <div class="code-block">
              <pre>&lt;?php
/**
 * Atomeek DataMatrix API Entry Point
 * Main entry point for all API requests
 */

// CORS headers for all requests
header('Access-Control-Allow-Origin: *');
header('Access-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS, PATCH');
header('Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept, Authorization, Cache-Control');
header('Content-Type: application/json');

// Handle preflight OPTIONS requests
if ($_SERVER['REQUEST_METHOD'] === 'OPTIONS') {
    http_response_code(200);
    exit();
}

// Load Composer autoloader
require_once __DIR__ . '/../vendor/autoload.php';

// Load environment variables
$dotenv = Dotenv\Dotenv::createImmutable(__DIR__ . '/..');
$dotenv->load();

// Initialize application
try {
    // Get route from URL
    $route = $_GET['route'] ?? '';
    $method = $_SERVER['REQUEST_METHOD'];

    // Basic routing system
    $router = new App\Core\Router();
    $router->dispatch($route, $method);

} catch (Exception $e) {
    http_response_code(500);
    echo json_encode([
        'error' => 'Internal server error',
        'message' => $e->getMessage(),
        'timestamp' => date('Y-m-d H:i:s')
    ]);
}</pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>

          <h3 class="section-subtitle">üìÑ environnement (.env)</h3>
          <div class="file-path">Chemin : /atkm_back/.env</div>
          <div class="code-container">
            <div class="code-block">
              <pre># Database Configuration
DB_HOST=mysql
DB_PORT=3306
DB_NAME=atomeek_datamatrix
DB_USER=atomeek_user
DB_PASS=atomeek_pass

# Application Environment
APP_ENV=development
APP_DEBUG=true
APP_URL=http://localhost:8000

# Redis Configuration (optional)
REDIS_HOST=redis
REDIS_PORT=6379

# Binance API Configuration
BINANCE_API_KEY=your_binance_api_key
BINANCE_API_SECRET=your_binance_api_secret

# JWT Configuration
JWT_SECRET=your-secret-key-change-in-production
JWT_EXPIRY=3600

# Upload Configuration
UPLOAD_MAX_SIZE=50M
UPLOAD_PATH=/var/www/html/public/uploads</pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>
        </div>

        <div class="content-section">
          <h2 class="section-title"><span class="emoji-icon">6Ô∏è‚É£</span>frontend angular 20</h2>

          <h3 class="section-subtitle">üì¶ package.json</h3>
          <div class="file-path">Chemin : /atkm/package.json</div>
          <div class="code-container">
            <div class="code-block">
              <pre>{
  "name": "atomeek-datamatrix-frontend",
  "version": "1.0.0",
  "description": "Frontend Angular pour Atomeek DataMatrix",
  "scripts": {
    "ng": "ng",
    "start": "ng serve --host 0.0.0.0",
    "start:dev": "ng serve --configuration development --host 0.0.0.0",
    "build": "ng build",
    "build:prod": "ng build --configuration production",
    "watch": "ng build --watch --configuration development",
    "test": "ng test",
    "test:headless": "ng test --watch=false --browsers=ChromeHeadless",
    "lint": "ng lint",
    "lint:fix": "ng lint --fix"
  },
  "private": true,
  "dependencies": {
    "@angular/animations": "^20.0.0",
    "@angular/cdk": "^20.0.0",
    "@angular/common": "^20.0.0",
    "@angular/compiler": "^20.0.0",
    "@angular/core": "^20.0.0",
    "@angular/forms": "^20.0.0",
    "@angular/material": "^20.0.0",
    "@angular/platform-browser": "^20.0.0",
    "@angular/platform-browser-dynamic": "^20.0.0",
    "@angular/router": "^20.0.0",
    "@ngrx/effects": "^20.0.0",
    "@ngrx/router-store": "^20.0.0",
    "@ngrx/store": "^20.0.0",
    "@ngrx/store-devtools": "^20.0.0",
    "@ngrx/entity": "^20.0.0",
    "rxjs": "^7.8.1",
    "tslib": "^2.7.0",
    "zone.js": "^0.15.0",
    "lodash": "^4.17.21"
  },
  "devDependencies": {
    "@angular-devkit/build-angular": "^20.0.0",
    "@angular/cli": "^20.0.0",
    "@angular/compiler-cli": "^20.0.0",
    "@angular-eslint/builder": "^18.0.1",
    "@angular-eslint/eslint-plugin": "^18.0.1",
    "@angular-eslint/eslint-plugin-template": "^18.0.1",
    "@angular-eslint/schematics": "^18.0.1",
    "@angular-eslint/template-parser": "^18.0.1",
    "@types/jasmine": "^5.1.4",
    "@types/lodash": "^4.17.7",
    "@types/node": "^22.5.4",
    "@typescript-eslint/eslint-plugin": "^8.0.0",
    "@typescript-eslint/parser": "^8.0.0",
    "eslint": "^9.9.1",
    "jasmine-core": "^5.2.0",
    "karma": "^6.4.4",
    "karma-chrome-launcher": "^3.2.0",
    "karma-coverage": "^2.2.1",
    "karma-jasmine": "^5.1.0",
    "karma-jasmine-html-reporter": "^2.1.0",
    "typescript": "^5.6.2"
  },
  "engines": {
    "node": ">=20.0.0",
    "npm": ">=10.0.0"
  }
}</pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>

          <h3 class="section-subtitle">‚öôÔ∏è angular.json</h3>
          <div class="file-path">Chemin : /atkm/angular.json</div>
          <div class="code-container">
            <div class="code-block">
              <pre>{
  "$schema": "./node_modules/@angular/cli/lib/config/schema.json",
  "version": 1,
  "newProjectRoot": "projects",
  "projects": {
    "atomeek-datamatrix": {
      "projectType": "application",
      "schematics": {
        "@schematics/angular:application": {
          "strict": true,
          "style": "scss",
          "routing": true,
          "standalone": true
        }
      },
      "root": "",
      "sourceRoot": "src",
      "prefix": "adm",
      "architect": {
        "build": {
          "builder": "@angular-devkit/build-angular:application",
          "options": {
            "outputPath": "dist/atomeek-datamatrix",
            "index": "src/index.html",
            "browser": "src/main.ts",
            "polyfills": [
              "zone.js"
            ],
            "tsConfig": "tsconfig.app.json",
            "assets": [
              {
                "glob": "**/*",
                "input": "public"
              },
              {
                "glob": "**/*",
                "input": "src/assets",
                "output": "/assets/"
              }
            ],
            "styles": [
              "@angular/material/prebuilt-themes/azure-blue.css",
              "src/styles.scss"
            ],
            "scripts": []
          },
          "configurations": {
            "production": {
              "budgets": [
                {
                  "type": "initial",
                  "maximumWarning": "1MB",
                  "maximumError": "2MB"
                }
              ],
              "outputHashing": "all",
              "optimization": true,
              "sourceMap": false
            },
            "development": {
              "optimization": false,
              "extractLicenses": false,
              "sourceMap": true
            }
          },
          "defaultConfiguration": "production"
        },
        "serve": {
          "builder": "@angular-devkit/build-angular:dev-server",
          "configurations": {
            "production": {
              "buildTarget": "atomeek-datamatrix:build:production"
            },
            "development": {
              "buildTarget": "atomeek-datamatrix:build:development"
            }
          },
          "defaultConfiguration": "development",
          "options": {
            "port": 4200,
            "host": "0.0.0.0"
          }
        }
      }
    }
  }
}</pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>

          <h3 class="section-subtitle">üêã dockerfile angular</h3>
          <div class="file-path">Chemin : /atkm/Dockerfile</div>
          <div class="code-container">
            <div class="code-block">
              <pre># Development stage
FROM node:20-alpine as development

# Set working directory
WORKDIR /app

# Copy package files
COPY package*.json ./

# Install dependencies
RUN npm ci

# Copy source code
COPY . .

# Expose development port
EXPOSE 4200

# Start development server
CMD ["npm", "run", "start:dev"]</pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>

          <h3 class="section-subtitle">üîß configuration proxy</h3>
          <div class="file-path">Chemin : /atkm/proxy.conf.json</div>
          <div class="code-container">
            <div class="code-block">
              <pre>{
  "/api/*": {
    "target": "http://nginx:80",
    "secure": false,
    "changeOrigin": true,
    "logLevel": "debug",
    "headers": {
      "Accept": "application/json",
      "Content-Type": "application/json"
    }
  },
  "/uploads/*": {
    "target": "http://nginx:80",
    "secure": false,
    "changeOrigin": true,
    "logLevel": "debug"
  }
}</pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>
        </div>

        <div class="content-section">
          <h2 class="section-title"><span class="emoji-icon">7Ô∏è‚É£</span>d√©marrage et tests</h2>

          <h3 class="section-subtitle">üöÄ proc√©dure de d√©marrage</h3>

          <div class="steps-container">
            <div class="steps-title">1. Pr√©paration du projet :</div>
            <div class="code-container">
              <div class="code-block">
                <pre># Clone or create the project directory
git clone [your-repo] atomeek-datamatrix
cd atomeek-datamatrix

# Create the required directory structure
mkdir -p atkm_back/public atkm_back/src/app
mkdir -p database docker/php docker/nginx
mkdir -p atkm/src/app</pre>
              </div>
              <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
            </div>
          </div>

          <div class="steps-container">
            <div class="steps-title">2. Copier les fichiers de configuration :</div>
            <ul class="steps-list">
              <li class="step-item">Copier tous les fichiers de configuration aux emplacements indiqu√©s</li>
              <li class="step-item">Ajuster les variables d'environnement dans <code>.env</code></li>
              <li class="step-item">V√©rifier les permissions sur les dossiers</li>
            </ul>
          </div>

          <div class="steps-container">
            <div class="steps-title">3. D√©marrage des containers :</div>
            <div class="code-container">
              <div class="code-block">
                <pre># Start all containers
docker-compose up -d

# Check containers status
docker-compose ps

# View logs if needed
docker-compose logs -f [service-name]</pre>
              </div>
              <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
            </div>
          </div>

          <div class="steps-container">
            <div class="steps-title">4. Installation des d√©pendances :</div>
            <div class="code-container">
              <div class="code-block">
                <pre># PHP dependencies
docker-compose exec php composer install

# Angular dependencies (if not using containerized Angular)
cd atkm && npm install</pre>
              </div>
              <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
            </div>
          </div>

          <h3 class="section-subtitle">‚úÖ v√©rification de l'installation</h3>
          <div class="cards-grid">
            <div class="info-card">
              <h4 class="card-title">üåê nginx (port 8000)</h4>
              <div class="card-content">
                <p><code>http://localhost:8000</code></p>
                <p>Devrait afficher la page d'accueil PHP</p>
              </div>
            </div>

            <div class="info-card">
              <h4 class="card-title">üÖ∞Ô∏è angular (port 4200)</h4>
              <div class="card-content">
                <p><code>http://localhost:4200</code></p>
                <p>Devrait afficher l'application Angular</p>
              </div>
            </div>

            <div class="info-card">
              <h4 class="card-title">üê¨ phpmyadmin (port 8080)</h4>
              <div class="card-content">
                <p><code>http://localhost:8080</code></p>
                <p>Interface de gestion MySQL</p>
              </div>
            </div>

            <div class="info-card">
              <h4 class="card-title">üî¥ redis (port 6379)</h4>
              <div class="card-content">
                <p><code>redis-cli ping</code></p>
                <p>Devrait r√©pondre "PONG"</p>
              </div>
            </div>
          </div>

          <h3 class="section-subtitle">üß™ tests de l'api</h3>
          <div class="code-container">
            <div class="code-block">
              <pre># Test basic API endpoint
curl -X GET http://localhost:8000/api/test

# Test with CORS
curl -X OPTIONS -H "Origin: http://localhost:4200" \
     -H "Access-Control-Request-Method: GET" \
     -H "Access-Control-Request-Headers: X-Requested-With" \
     http://localhost:8000/api/test</pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>
        </div>

        <div class="content-section">
          <h2 class="section-title"><span class="emoji-icon">8Ô∏è‚É£</span>r√©solution de probl√®mes</h2>

          <h3 class="section-subtitle">üêã probl√®mes docker</h3>

          <div class="cards-grid">
            <div class="info-card">
              <h4 class="card-title">‚ùå probl√®me : "docker: command not found"</h4>
              <div class="card-content">
                <p><strong>Solution :</strong></p>
                <ul class="content-list">
                  <li class="list-item">Red√©marrer Docker Desktop</li>
                  <li class="list-item">V√©rifier que Docker Desktop est en cours d'ex√©cution</li>
                  <li class="list-item">Red√©marrer le terminal/PowerShell</li>
                  <li class="list-item">R√©installer Docker Desktop si n√©cessaire</li>
                </ul>
              </div>
            </div>

            <div class="info-card">
              <h4 class="card-title">‚ùå probl√®me : "WSL 2 installation is incomplete"</h4>
              <div class="card-content">
                <p><strong>Solution :</strong></p>
                <div class="code-container">
                  <div class="code-block">
                    <pre># Update WSL
wsl --update

# Set default version
wsl --set-default-version 2

# Restart Docker Desktop</pre>
                  </div>
                  <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
                </div>
              </div>
            </div>

            <div class="info-card">
              <h4 class="card-title">‚ùå probl√®me : "Port already in use"</h4>
              <div class="card-content">
                <p><strong>Solution :</strong></p>
                <div class="code-container">
                  <div class="code-block">
                    <pre># Find process using port
netstat -ano | findstr :8000

# Kill process (replace PID)
taskkill /PID [process_id] /F

# Or change port in docker-compose.yml</pre>
                  </div>
                  <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
                </div>
              </div>
            </div>
          </div>

          <h3 class="section-subtitle">üêò probl√®mes php</h3>

          <div class="cards-grid">
            <div class="info-card">
              <h4 class="card-title">‚ùå probl√®me : "composer install fails"</h4>
              <div class="card-content">
                <p><strong>Solution :</strong></p>
                <div class="code-container">
                  <div class="code-block">
                    <pre># Clear composer cache
docker-compose exec php composer clear-cache

# Install with verbose output
docker-compose exec php composer install -vvv

# Update composer
docker-compose exec php composer self-update</pre>
                  </div>
                  <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
                </div>
              </div>
            </div>

            <div class="info-card">
              <h4 class="card-title">‚ùå probl√®me : "Database connection failed"</h4>
              <div class="card-content">
                <p><strong>Solution :</strong></p>
                <ul class="content-list">
                  <li class="list-item">V√©rifier que le container MySQL est d√©marr√©</li>
                  <li class="list-item">V√©rifier les variables d'environnement dans <code>.env</code></li>
                  <li class="list-item">Attendre que MySQL soit compl√®tement initialis√©</li>
                </ul>
                <div class="code-container">
                  <div class="code-block">
                    <pre># Check MySQL logs
docker-compose logs mysql

# Test connection
docker-compose exec php php -r "echo 'MySQL: ' . (new PDO('mysql:host=mysql;dbname=atomeek_datamatrix', 'atomeek_user', 'atomeek_pass') ? 'Connected' : 'Failed');"</pre>
                  </div>
                  <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
                </div>
              </div>
            </div>
          </div>

          <h3 class="section-subtitle">üÖ∞Ô∏è probl√®mes angular</h3>

          <div class="cards-grid">
            <div class="info-card">
              <h4 class="card-title">‚ùå probl√®me : "npm install fails"</h4>
              <div class="card-content">
                <p><strong>Solution :</strong></p>
                <div class="code-container">
                  <div class="code-block">
                    <pre># Clear npm cache
npm cache clean --force

# Delete node_modules and reinstall
rm -rf node_modules package-lock.json
npm install

# Use specific Node version
nvm use 20</pre>
                  </div>
                  <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
                </div>
              </div>
            </div>

            <div class="info-card">
              <h4 class="card-title">‚ùå probl√®me : "CORS errors in browser"</h4>
              <div class="card-content">
                <p><strong>Solution :</strong></p>
                <ul class="content-list">
                  <li class="list-item">V√©rifier la configuration proxy dans <code>proxy.conf.json</code></li>
                  <li class="list-item">V√©rifier les headers CORS dans Nginx et .htaccess</li>
                  <li class="list-item">Red√©marrer les containers apr√®s modification</li>
                </ul>
              </div>
            </div>
          </div>

          <h3 class="section-subtitle">üîß commandes utiles</h3>
          <div class="code-container">
            <div class="code-block">
              <pre># View all container logs
docker-compose logs

# View specific service logs
docker-compose logs -f nginx
docker-compose logs -f php
docker-compose logs -f mysql

# Execute commands in containers
docker-compose exec php bash
docker-compose exec mysql mysql -u root -p

# Restart specific service
docker-compose restart nginx
docker-compose restart php

# Rebuild containers
docker-compose down
docker-compose up --build -d

# Clean Docker system
docker system prune -a
docker volume prune</pre>
            </div>
            <button class="copy-button" onclick="copyToClipboard(this)">Copier</button>
          </div>
        </div>

        <div class="next-steps-section">
          <h2 class="next-steps-title"><span class="emoji-icon">‚úÖ</span>installation termin√©e</h2>
          <p class="section-text">Si tous les tests passent, votre environnement <strong>atomeek datamatrix</strong> est
            pr√™t pour le d√©veloppement !</p>

          <h3 class="section-subtitle">URLs de d√©veloppement :</h3>
          <ul class="content-list">
            <li class="list-item"><strong>Angular :</strong> <code>http://localhost:4200</code></li>
            <li class="list-item"><strong>API PHP :</strong> <code>http://localhost:8000</code></li>
            <li class="list-item"><strong>PhpMyAdmin :</strong> <code>http://localhost:8080</code></li>
          </ul>
        </div>
      </div>

      <div class="document-footer">
        <div class="footer-title">üöÄ atomeek datamatrix - guide d'installation complet</div>
        <p>Documentation g√©n√©r√©e pour Angular 20 + PHP 8.3 + Docker sur Windows 11</p>
      </div>
    </div>
  </div>

  <script>
    // Fonction de copie dans le presse-papiers
    async function copyToClipboard(button) {
      const codeBlock = button.previousElementSibling;
      const code = codeBlock.innerText;

      try {
        await navigator.clipboard.writeText(code);

        // Feedback visuel
        const originalText = button.textContent;
        button.textContent = 'Copi√© !';
        button.classList.add('copied');

        // Retour √† l'√©tat normal apr√®s 2 secondes
        setTimeout(() => {
          button.textContent = originalText;
          button.classList.remove('copied');
        }, 2000);

      } catch (err) {
        // Fallback pour les navigateurs plus anciens
        const textArea = document.createElement('textarea');
        textArea.value = code;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);

        // Feedback visuel
        const originalText = button.textContent;
        button.textContent = 'Copi√© !';
        button.classList.add('copied');

        setTimeout(() => {
          button.textContent = originalText;
          button.classList.remove('copied');
        }, 2000);
      }
    }

    // Smooth scrolling pour les liens d'ancrage
    document.addEventListener('DOMContentLoaded', function () {
      const links = document.querySelectorAll('a[href^="#"]');
      links.forEach(link => {
        link.addEventListener('click', function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            target.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
          }
        });
      });
    });
  </script>
</body>

</html>
