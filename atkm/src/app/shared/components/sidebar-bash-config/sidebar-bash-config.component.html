<div class="sidebar-bash-config">

  <!-- Header Section -->
  <div class="sidebar-header">
    <div class="sidebar-title">
      <atk-icon name="settings" [size]="16" color="var(--color-accent-fg)" />
      <h3>{{ configTitle() || 'API Configuration' }}</h3>
    </div>

    @if (loading()) {
    <div class="sidebar-status loading">
      <atk-icon name="loader" [size]="14" color="var(--color-accent-fg)" />
      <span>Loading...</span>
    </div>
    } @else if (error()) {
    <div class="sidebar-status error">
      <atk-icon name="alert-circle" [size]="14" color="var(--color-danger)" />
      <span>{{ error() }}</span>
    </div>
    } @else if (hasData()) {
    <div class="sidebar-status success">
      <atk-icon name="check-circle" [size]="14" color="var(--color-success-emphasis)" />
      <span>Connected</span>
    </div>
    }
  </div>

  <!-- Current Endpoint Info -->
  @if (currentEndpoint()) {
  <div class="sidebar-section">
    <div class="section-header">
      <atk-icon name="globe" [size]="14" color="var(--color-fg-muted)" />
      <span class="section-title">Endpoint</span>
    </div>
    <div class="section-content">
      <div class="endpoint-name">{{ getEndpointName() }}</div>
      <div class="endpoint-id">{{ currentEndpoint() }}</div>
    </div>
  </div>
  }

  <!-- Data Summary -->
  @if (summary(); as summaryData) {
  <div class="sidebar-section">
    <div class="section-header">
      <atk-icon name="bar-chart" [size]="14" color="var(--color-fg-muted)" />
      <span class="section-title">Data Summary</span>
    </div>
    <div class="section-content">
      <div class="data-metric">
        <span class="metric-label">Sidebar Fields:</span>
        <span class="metric-value">{{ summaryData.sidebarFields }}</span>
      </div>
      <div class="data-metric">
        <span class="metric-label">Table Rows:</span>
        <span class="metric-value">{{ summaryData.tableRows }}</span>
      </div>
      @if (summaryData.lastUpdate) {
      <div class="data-metric">
        <span class="metric-label">Last Update:</span>
        <span class="metric-value timestamp">{{ formatTimestamp(summaryData.lastUpdate) }}</span>
      </div>
      }
    </div>
  </div>
  }

  <!-- Sidebar Fields Data -->
  @if (displayFields().length > 0) {
  <div class="sidebar-section">
    <div class="section-header">
      <atk-icon name="list" [size]="14" color="var(--color-fg-muted)" />
      <span class="section-title">Account Info</span>
    </div>
    <div class="section-content">
      @for (fieldDisplay of displayFields(); track fieldDisplay.field.key) {
      @if (fieldDisplay.visible) {
      <div class="field-row" [ngClass]="'field-' + fieldDisplay.field.type">
        <div class="field-label">
          @if (fieldDisplay.field.icon) {
          <atk-icon [name]="fieldDisplay.field.icon" [size]="12" color="var(--color-fg-muted)" />
          }
          <span>{{ fieldDisplay.field.label }}:</span>
        </div>
        <div class="field-value" [ngClass]="fieldDisplay.field.cssClass">
          @switch (fieldDisplay.field.type) {
          @case ('boolean') {
          <span class="boolean-badge" [ngClass]="fieldDisplay.value ? 'true' : 'false'">
            <atk-icon [name]="fieldDisplay.value ? 'check' : 'x'" [size]="10" />
            {{ fieldDisplay.value ? 'Yes' : 'No' }}
          </span>
          }
          @case ('status') {
          <span class="status-badge" [ngClass]="'status-' + (fieldDisplay.value || '').toLowerCase()">
            {{ fieldDisplay.formattedValue }}
          </span>
          }
          @case ('date') {
          <span class="date-value">{{ fieldDisplay.formattedValue }}</span>
          }
          @default {
          <span class="text-value">{{ fieldDisplay.formattedValue }}</span>
          }
          }
        </div>
      </div>
      }
      }
    </div>
  </div>
  }

  <!-- Debug Info (Development Only) -->
  @if (showDebugInfo()) {
  <div class="sidebar-section debug-section">
    <div class="section-header">
      <atk-icon name="bug" [size]="14" color="var(--color-warning)" />
      <span class="section-title">Debug Info</span>
    </div>
    <div class="section-content">
      <pre class="debug-data">{{ getDebugInfo() }}</pre>
    </div>
  </div>
  }
</div>
